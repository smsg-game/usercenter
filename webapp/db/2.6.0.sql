-- ----------------------------
-- Table structure for PAY_GAME
-- ----------------------------
CREATE TABLE "EAUSER"."PAY_GAME" (
  "APP_ID" NUMBER NOT NULL,
  "NAME" VARCHAR2(255 BYTE) NOT NULL,
  "PARTNER_ID" NUMBER NOT NULL,
  constraint PK_APP_ID PRIMARY KEY ("APP_ID")
);


-- ----------------------------
-- Records of PAY_GAME
-- ----------------------------
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('100', '梵町E币充值', '1000100010001006');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('101', '梵町书城-网页版', '1000100010001010');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1328', '梵町斗地主', '1000100010001003');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1330', '小鸟OL', '1000100010001007');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1331', '三国时代', '1000100010001017');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1341', '启航斗地主', '1000100010001008');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1357', 'Q将水浒', '1000100010001009');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1368', '上古封神', '1000100010001011');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1369', '达人德州扑克', '1000100010001013');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1375', '霸气三国', '1000100010001020');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1377', '博雅德州扑克', '1000100010001014');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1379', 'Q卡三国', '1000100010001012');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1394', '末日大冒险', '1000100010001016');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1395', '幻想三国卡牌版', '1000100010001018');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1400', '三国制霸', '1000100010001019');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1401', '天珠', '1000100010001021');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1647', '凡人修仙传', '1000100010001024');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1649', '仙旅奇缘', '1000100010001027');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1685', '三国合伙人', '1000100010001028');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1686', '将星录', '1000100010001026');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1687', '三国合伙人IOS', '1000100010001029');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('9001', '梵町游戏内部测试账号1', '1000100020000001');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('9002', '梵町游戏内部测试账号2', '1000100020000002');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1211060012', '三国杀', '1000100010001001');
INSERT INTO "EAUSER"."PAY_GAME" VALUES ('1211060013', '抬杠', '1000100010001002');

-- 增加两个字段
ALTER TABLE "EAUSER"."EUC_APP" ADD (APP_ID NUMBER);
ALTER TABLE "EAUSER"."EUC_APP" ADD (PARTNER_ID NUMBER);

-- 转移partnerId数据
UPDATE "EAUSER"."EUC_APP" eapp SET eapp.PARTNER_ID = eapp.ID;

-- 替换新的ID字段
ALTER TABLE "EAUSER"."EUC_APP" DROP COLUMN ID;
ALTER TABLE "EAUSER"."EUC_APP" ADD (ID NUMBER);

-- 添加ID与AppId的值
UPDATE "EAUSER"."EUC_APP" eapp SET 
	ID = (SELECT RNUM FROM 
		(
			SELECT PARTNER_ID,ROWNUM AS RNUM 
				FROM (SELECT PARTNER_ID FROM "EAUSER"."EUC_APP" ORDER BY CREATE_TIME ASC)
		) 
	eapp2  WHERE eapp2.PARTNER_ID = eapp.PARTNER_ID),
	APP_ID = (SELECT pgame.APP_ID FROM "EAUSER"."PAY_GAME" pgame WHERE pgame.PARTNER_ID = eapp.PARTNER_ID);

-- 设置ID为主键
ALTER TABLE "EAUSER"."EUC_APP" ADD CONSTRAINT PK_ID PRIMARY KEY(ID);


-- 斗你妹
UPDATE "EAUSER"."EUC_APP" SET PARTNER_ID = '1000100010001010' WHERE SECERT = 'E502886D2A3164BB267763734A2C3C20';
-- 老的Android三国
UPDATE "EAUSER"."EUC_APP" SET "NAME" = 'Newtab_old',APP_ID = NULL,"PARTNER_ID" = '1000100010001010' 
		WHERE SECERT = '44F3411D4C4A490F91D2D16C893C5145';
-- IOS三国
UPDATE "EAUSER"."EUC_APP" SET "PARTNER_ID" = '1000100010001010' WHERE SECERT = 'A6102A5C05414A24A8D5F9D25A9A0F04';
-- Android三国
UPDATE "EAUSER"."EUC_APP" SET "NAME" = 'Newtab',APP_ID = '1685',"PARTNER_ID" = '1000100010001010' 
		WHERE SECERT = '8C97398507CCD24342C835D7AB09077D';


-- 删除临时数据表
DROP TABLE "EAUSER"."PAY_GAME";

